# All Pair Partition

## 1. Theta Join

> 조인 조건에 기본 연산자를 사용해서 나온 결과를 출력한다.

- 두 테이블 간의 모든 튜플 쌍에 대하여 조인 칼럼 값이 일치하면 두 쌍을 출력한다.

  ```sql
  SELECT * FROM R, S WHERE R.A = S.A;
  ```



## 2. All Pair Partition

> equi join 알고리즘 or similarity join 알고리즘을 할 때 맵 리듀스를 하게 되면 모든 가능한 쌍을 여러 머신에 비슷한 개수로 나눠놓고 각각 따져서 계산을 하게 되면 분산처리를 할 수 있다.

- 테이블 R과 S에 대해서 |R| * |S| 튜플 쌍을 다 고려한다.
  - R과 S를 각각 u개 파티션과 v개 파티션으로 분할한다.
  - |R| * |S|개의 튜플(레코드) 쌍을 `u * v` 개의 `disjoint`한 파티션으로 분할한다.
    - |R|, |S| : 각각 R과 S에 들어 있는 튜플의 개수
  - 각각의 파티션을 한 개의 reduce 함수로 처리한다.
- 장점
  - 어떤 조인 조건이라도 처리 가능하다.
  - 모든 reduce 함수에 들어가는 입력 사이즈가 다 비슷하다.
- 단점
  - 모든 튜플 쌍을 다 검사해야 한다.
  - 각각의 Reduce 함수의 출력 사이즈가 많이 다를 수 있다.



## 3. Self-join

> 한 개의 입력 테이블 D에 들어있는 레코드들 간의 조인을 말한다.

- 입력 테이블에 있는 레코드들을 m개의 파티션으로 나눈다.

- 첫 번째 파티션 : 테이블이 S의 세개의 파티션 모두에 다 보내야 한다.

- 두 번째 파티션 : 테이블이 S의 두 개의 파티션에만 보내야 한다.

- 세 번째 파티션 : 테이블이 S의 자신이 속한 파티션에만 보내야 한다.

  